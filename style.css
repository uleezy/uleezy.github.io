#intro-screen {
    opacity: 1;
    transition: opacity 0.8s ease;
}

#intro-screen.fade-out {
    opacity: 0;
}
/* ============================================================
   INTRO SEQUENCE
   ============================================================ */
let introLoop = new Audio("assets/music/intro_loop.mp3");
introLoop.loop = true;
introLoop.volume = 0.35;

window.onload = () => {
    introLoop.play().catch(() => {
        console.log("Autoplay blocked until user interacts.");
    });
};

const pressStartBtn = document.getElementById("press-start-btn");
const introScreen = document.getElementById("intro-screen");
const siteWrapper = document.getElementById("site-wrapper");
const gba = document.getElementById("gba-container");

pressStartBtn.addEventListener("click", () => {
    // Fade out intro loop
    let fadeOut = setInterval(() => {
        if (introLoop.volume > 0.01) {
            introLoop.volume -= 0.02;
        } else {
            clearInterval(fadeOut);
            introLoop.pause();
        }
    }, 80);

    introScreen.style.transition = "opacity 1.3s ease";
    introScreen.style.opacity = "0";

    setTimeout(() => {
        introScreen.style.display = "none";
        siteWrapper.style.display = "flex";

        // Animate the GBA SP sliding up
        setTimeout(() => {
            gba.style.opacity = "1";
            gba.style.transform = "translateY(0)";
        }, 100);
    }, 1200);
});


/* ============================================================
   CENSOR RANDOM SYMBOLS
   ============================================================ */
const censorWord = document.getElementById("censor-word");
const censorSymbols = ["@#$%&*!?", "*%@!#%", "!$#*@&", "%#@!*%", "&*!@#$"];

setInterval(() => {
    censorWord.textContent = censorSymbols[Math.floor(Math.random() * censorSymbols.length)];
}, 200);


/* ============================================================
   GALLERY ROTATION
   ============================================================ */
const galleryImg = document.getElementById("gallery-img");

const galleryImages = [
    "https://i.pinimg.com/736x/4f/e4/d2/4fe4d27ec4e7beef97429f855383384c.jpg",
    "https://i.pinimg.com/736x/43/fe/d2/43fed25a912fd4e44af1d35b9aac6a01.jpg",
    "https://i.pinimg.com/736x/4a/90/45/4a9045416707ca4f825c70cb81079ebb.jpg",
    "https://i.pinimg.com/736x/68/d8/e6/68d8e6a18aac67bb0b47c8ec77ec1cd2.jpg",
    "https://i.pinimg.com/736x/86/6d/22/866d220dbf59a6aee104196a586c0832.jpg"
];

let currentGalleryIndex = 0;
setInterval(() => {
    currentGalleryIndex = (currentGalleryIndex + 1) % galleryImages.length;
    galleryImg.src = galleryImages[currentGalleryIndex];
}, 6000);


/* ============================================================
   KAOMOJI SYSTEM
   ============================================================ */
const kaomojiLayer = document.getElementById("kaomoji-layer");

const kaomojiList = [
    "(｡•́‿•̀｡)", "(≧◡≦)", "(•ө•)♡", "(っ˘з(˘⌣˘ )", "(⌒‿⌒)", "(=｀ω´=)",
    "(ﾉ◕ヮ◕)ﾉ*:･ﾟ✧", "(╯✧▽✧)╯", "(◕ᴥ◕)", "(✿◠‿◠)", "(´｡• ◡ •｡`)"
];

function spawnKaomoji() {
    if (document.hidden) return;

    if (kaomojiLayer.childElementCount > 10) return;

    const k = document.createElement("div");
    k.classList.add("kaomoji");
    k.innerText = kaomojiList[Math.floor(Math.random() * kaomojiList.length)];

    k.style.left = Math.random() * 90 + "%";
    k.style.top = "110%";
    k.style.opacity = 0.5 + Math.random() * 0.4;

    kaomojiLayer.appendChild(k);

    setTimeout(() => k.remove(), 6000);
}

setInterval(spawnKaomoji, 1200);


/* ============================================================
   MUSIC PLAYER — SHUFFLE SYSTEM
   ============================================================ */
const playBtn = document.getElementById("play-btn");
const pauseBtn = document.getElementById("pause-btn");
const skipBtn = document.getElementById("skip-btn");
const volumeSlider = document.getElementById("volume-slider");

const songs = [
    "assets/music/song1.mp3",
    "assets/music/song2.mp3",
    "assets/music/song3.mp3",
    "assets/music/song4.mp3",
    "assets/music/song5.mp3",
    "assets/music/song6.mp3",
    "assets/music/song7.mp3"
];

let currentSong = null;

function playRandomSong() {
    if (currentSong) {
        currentSong.pause();
    }

    let pick = songs[Math.floor(Math.random() * songs.length)];
    currentSong = new Audio(pick);
    currentSong.volume = volumeSlider.value;
    currentSong.play();

    currentSong.onended = () => playRandomSong();
}

playBtn.addEventListener("click", () => {
    if (!currentSong) {
        playRandomSong();
    } else {
        currentSong.play();
    }
});

pauseBtn.addEventListener("click", () => {
    if (currentSong) currentSong.pause();
});

skipBtn.addEventListener("click", () => {
    playRandomSong();
});

volumeSlider.addEventListener("input", () => {
    if (currentSong) currentSong.volume = volumeSlider.value;
});


/* ============================================================
   MUSIC PLAYER POPUP
   ============================================================ */
const musicPlayer = document.getElementById("music-player");
const gbaA = document.getElementById("gba-a");
const gbaB = document.getElementById("gba-b");

gbaA.addEventListener("click", () => {
    musicPlayer.style.display = "flex";
});

gbaB.addEventListener("click", () => {
    musicPlayer.style.display = "none";
});


/* ============================================================
   HIDDEN FETU EASTER EGG
   ============================================================ */
const fetuEgg = document.getElementById("fetu-egg");

fetuEgg.addEventListener("click", () => {
    alert("✨ Fetu appears for a split second… then vanishes.");
});

